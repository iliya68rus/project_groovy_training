pipeline {
    agent any

    environment {
        MODULES = getModules()
    }

//     tools {
//         maven "M3"
//     }

    stages {
        stage('PrintSysTime') {
            steps {
                echo "branch name: ${branch}"
                script {
                    def now = java.time.LocalDateTime.now()
                    def time = now.format(java.time.format.DateTimeFormatter.ofPattern("HH:mm:ss dd.MM.yyyy"))
                    echo "time: ${time}"
                }
            }
        }
        stage('Build') {
            steps {
                script {
                    println "modules = ${env.MODULES}"
//                     for (module in env.MODULES) {
//                         dir(module) {
//                             sh "mvn clean package"
//                             sh "mvn --projects sample-client-connector,sample-rest install"
//                         }
//                     }
//                     sh "mvn --projects hw01-gradle,hw02-gradle clean package"
                    sh "gradlew clean build"
                }
            }
        }
    }
}

def getModules() {
    ['hw01-gradle', 'hw02-gradle', 'hw03-gradle', 'hw04-gradle', 'hw05-gradle']
}