pipeline {
    agent any

    environment {
        MODULES = "hw01-gradle,hw02-gradle,hw03-gradle,hw04-gradle,hw05-gradle"
    }

    tools {
        gradle "GR"
    }

    stages {
        stage('PrintSysTime') {
            steps {
                echo "branch name: ${branch}"
                script {
                    def now = java.time.LocalDateTime.now()
                    def time = now.format(java.time.format.DateTimeFormatter.ofPattern("HH:mm:ss dd.MM.yyyy"))
                    echo "time: ${time}"
                }
            }
        }
        stage('Build') {
            steps {
                script {
                    println "modules = ${env.MODULES}"
//                     for (def module in env.MODULES) {
                    for (def module in env.MODULES.split(",")) {
//                         if (module.contains('[') || module.contains(']')) {
//                             continue
//                         }
// //                         dir(module) {
                        println "module name: ${module}"
                        sh "./gradlew ${module}:clean ${module}:build"
// //                         }
                    }

//                     sh "./gradlew hw01-gradle:clean hw01-gradle:build"
//                     sh "./gradlew clean build"
                }
            }
        }
    }
}

// def getModules() {
//     ['hw01-gradle', 'hw02-gradle', 'hw03-gradle', 'hw04-gradle', 'hw05-gradle']
// }